import plotly.graph_objects as go
import pandas as pd

# Read the data from 'testfetch.csv' file
df = pd.read_csv('C:/Users/Zorawer/Desktop/testfetch.csv')

# Filter the data for completed and work-in-progress schemes
completed_data = df[df['Drilling Status'] == 'Completed']
wip_data = df[df['Drilling Status'] == 'WIP']

# Calculate the number of completions and WIP schemes by month
completed_counts = completed_data['T/W Drill Start Date'].dt.month.value_counts().sort_index()
wip_counts = wip_data['T/W Drill Start Date'].dt.month.value_counts().sort_index()

# Create the drilling chart
drilling_chart = go.Figure()

# Add line chart for completions
drilling_chart.add_trace(go.Scatter(
    x=completed_counts.index,
    y=completed_counts.values,
    mode='lines+markers',
    name='Completed',
    line=dict(color='blue'),
    marker=dict(color='blue', symbol='circle'),
    text='Completed: ' + completed_counts.astype(str),
    hovertemplate='%{xaxis.title.text}: %{x}<br>%{text}'
))

# Add markers for WIP schemes
drilling_chart.add_trace(go.Scatter(
    x=wip_counts.index,
    y=wip_counts.values,
    mode='markers',
    name='WIP',
    marker=dict(color='red', symbol='circle-open'),
    text='WIP: ' + wip_counts.astype(str),
    hovertemplate='%{xaxis.title.text}: %{x}<br>%{text}'
))

# Update layout
drilling_chart.update_layout(
    title='Drilling Completion by Month',
    xaxis=dict(title='Month', tickmode='linear', tick0=1, dtick=1),
    yaxis=dict(title='Number of Schemes', range=[0, max(completed_counts.max(), wip_counts.max()) + 2]),
    legend=dict(title='Legend', x=1.05, y=0.5, bgcolor='rgba(255, 255, 255, 0.7)', orientation='v', traceorder='normal'),
    showlegend=True
)

# Show the chart
drilling_chart.show()
