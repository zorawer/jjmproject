<!DOCTYPE html>
<html>
<head>
    <title>Drilling and Lowering Completion</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <div id="wip-pipe-laying-chart"></div>

    <script>
        // Fetch data from the CSV file
        fetch('https://zorawer.github.io/jjmproject/testfetch.csv')
            .then(response => response.text())
            .then(data => {
                // Process the data
                const parsedData = Plotly.d3.csv.parse(data);

                // Filter the schemes with D/N Pipe Laying Status as 'WIP'
                const wipSchemes = parsedData.filter(row => row['D/N Pipe Laying Status'] === 'WIP');

                // Calculate the sum of Distribition System Length (scope) and D/N Excavation (m) (work done)
                const scope = wipSchemes.reduce((total, row) => total + parseInt(row['Distribition System Length']), 0);
                const workDone = wipSchemes.reduce((total, row) => total + parseInt(row['D/N Excavation (m)']), 0);

                // Create the WIP Pipe Laying pie chart data
                const labels = ['Scope', 'Work Done'];
                const values = [scope, workDone];

                // Create the WIP Pipe Laying pie chart
                const pieChart = {
                    labels: labels,
                    values: values,
                    type: 'pie'
                };

                const pieLayout = {
                    title: 'Work Progress (WIP)',
                };

                // Create the WIP Pipe Laying pie chart
                Plotly.newPlot('wip-pipe-laying-chart', [pieChart], pieLayout);
            })
            .catch(error => console.error(error));
    </script>
</body>
</html>
