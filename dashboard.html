<!DOCTYPE html>
<html>
<head>
    <title>Drilling and Lowering Completion</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .chart-container {
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <h1>JJM - HFCL Project Dashboard</h1>

    <div class="chart-container">
        <div id="drilling-chart"></div>
        <div id="lowering-chart"></div>
    </div>
    <div class="chart-container">
        <div id="pipe-laying-pie-chart"></div>
        <div id="wip-pie-chart"></div>
    </div>
    <ul id="wip-scheme-list"></ul>

    <script>
        // Fetch data from the CSV file
        fetch('https://zorawer.github.io/jjmproject/testfetch.csv')
            .then(response => response.text())
            .then(data => {
                // Process the data
                const parsedData = Plotly.d3.csv.parse(data);

                // Group the data, create charts, and handle click events

                // ... (code for grouping, creating charts, and handling click events)

                // Attach click event handler to WIP pie chart
                const wipPieChartElement = document.getElementById('wip-pie-chart');
                wipPieChartElement.on('plotly_click', event => {
                    const label = event.points[0].label;
                    if (label === 'WIP') {
                        const wipSchemes = parsedData.filter(row => row['D/N Pipe Laying Status'] === 'WIP');
                        const wipSchemeList = document.getElementById('wip-scheme-list');
                        wipSchemeList.innerHTML = ''; // Clear previous list
                        wipSchemes.forEach(row => {
                            const schemeID = row['Scheme ID'];
                            const schemeName = row['Scheme Name'];
                            const listItem = document.createElement('li');
                            listItem.textContent = `${schemeID} - ${schemeName}`;
                            wipSchemeList.appendChild(listItem);
                        });
                    }
                });
            })
            .catch(error => console.error(error));
    </script>
</body>
</html>
