<!DOCTYPE html>
<html>
<head>
    <title>Drilling and Lowering Completion</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .chart-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .chart {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="chart-container">
        <div id="drilling-chart" class="chart"></div>
        <div id="lowering-chart" class="chart"></div>
    </div>
    <div class="chart-container">
        <div id="pipe-laying-pie-chart" class="chart"></div>
    </div>

    <script>
        // Fetch data from the CSV file
        fetch('https://zorawer.github.io/jjmproject/testfetch.csv')
            .then(response => response.text())
            .then(data => {
                // Process the data
                const parsedData = Plotly.d3.csv.parse(data);

                // Group the data by month for drilling completion
                const drillingData = parsedData.reduce((accumulator, row) => {
                    // ... (code for grouping data by month for drilling completion)
                }, {});

                // Group the data by month for lowering completion
                const loweringData = parsedData.reduce((accumulator, row) => {
                    // ... (code for grouping data by month for lowering completion)
                }, {});

                // Group the data by D/N Pipe Laying Status
                const pipeLayingStatusData = parsedData.reduce((accumulator, row) => {
                    const status = row['D/N Pipe Laying Status'];
                    if (status === 'Not Started' || status === 'WIP') {
                        if (accumulator.hasOwnProperty(status)) {
                            accumulator[status]++;
                        } else {
                            accumulator[status] = 1;
                        }
                    }
                    return accumulator;
                }, {});

                // Create the drilling chart data
                // ... (code for creating drilling chart data)

                // Create the lowering chart data
                // ... (code for creating lowering chart data)

                // Create the pipe laying pie chart data
                const pipeLayingLabels = ['Not Started', 'WIP'];
                const pipeLayingValues = [pipeLayingStatusData['Not Started'] || 0, pipeLayingStatusData['WIP'] || 0];

                const pipeLayingPieChart = {
                    labels: pipeLayingLabels,
                    values: pipeLayingValues,
                    type: 'pie',
                    textposition: 'inside',
                    hoverinfo: 'label+value',
                    textinfo: 'percent',
                    marker: {
                        colors: ['#808080', '#FFA500']
                    }
                };

                const drillingChartLayout = {
                    title: 'Drilling Completion by Month',
                    xaxis: {
                        title: 'Month'
                    },
                    yaxis: {
                        title: 'Number of Drilling Schemes'
                    }
                };

                const loweringChartLayout = {
                    title: 'Lowering Completion by Month',
                    xaxis: {
                        title: 'Month'
                    },
                    yaxis: {
                        title: 'Number of Lowering Schemes'
                    }
                };

                const pipeLayingPieChartLayout = {
                    title: 'D/N Pipe Laying Status',
                };

                // Create the drilling chart
                Plotly.newPlot('drilling-chart', [drillingChart, drillingWIPMarker], drillingChartLayout);

                // Create the lowering chart
                Plotly.newPlot('lowering-chart', [loweringChart, loweringWIPMarker], loweringChartLayout);

                // Create the pipe laying pie chart
                Plotly.newPlot('pipe-laying-pie-chart', [pipeLayingPieChart], pipeLayingPieChartLayout);
            })
            .catch(error => console.error(error));
    </script>
</body>
</html>
